{% extends "base.html" %}

{% block title %}NOTHS Sellers A–Z Directory{% endblock %}

{% block content %}
  <section class="seller-directory">
    <h1>NOTHS Sellers A–Z</h1>

    <!-- A–Z Sticky Nav -->
    <nav class="az-nav sticky-nav">
      <ul class="az-bar">
        {% for letter in letters %}
          <li><a href="#{{ letter }}">{{ letter }}</a></li>
        {% endfor %}
      </ul>
    </nav>

    <!-- Sellers Grouped by Letter -->
    {% for letter, group in sellers_by_letter.items() %}
      <section class="letter-block" id="{{ letter }}">
        <h2 class="letter-title">{{ letter }}</h2>
        <ul class="seller-columns">
          {% for seller in group %}
            <li>
              <a href="/output/sellers/{{ seller.slug[0] }}/{{ seller.slug }}.html">{{ seller.name }}</a>
            </li>
          {% endfor %}
        </ul>
      </section>
    {% endfor %}
  </section>
{% block scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const navLinks = document.querySelectorAll(".az-nav a, .persistent-nav a");
    const sections = [];

    navLinks.forEach(link => {
      const id = link.getAttribute("href").replace("#", "");
      const section = document.getElementById(id);
      if (section) {
        sections.push({ id, section });
      }
    });

    function updateActiveNav() {
      let currentId = null;
      const scrollPosition = window.scrollY + (window.innerWidth > 768 ? 180 : 120);

      for (let i = 0; i < sections.length; i++) {
        const { id, section } = sections[i];
        if (section.offsetTop <= scrollPosition) {
          currentId = id;
        } else {
          break;
        }
      }

      navLinks.forEach(link => {
        link.classList.remove("active");
        if (link.getAttribute("href") === `#${currentId}`) {
          link.classList.add("active");
        }
      });
    }

    window.addEventListener("scroll", updateActiveNav);
    updateActiveNav();
  });
</script>
{% endblock %}

