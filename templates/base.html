<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Most Reviews{% endblock %}</title>
  <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>

  {% include "partials/header.html" %}

  <main>
    {% block content %}{% endblock %}
  </main>

  {% include "partials/footer.html" %}

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const navLinks = document.querySelectorAll(".az-nav a, .persistent-nav a");
    const sections = [];

    navLinks.forEach(link => {
      const id = link.getAttribute("href").replace("#", "");
      const section = document.getElementById(id);
      if (section) {
        sections.push({ id, section });
      }
    });

    function updateActiveNav() {
      let currentId = null;
      const scrollPosition = window.scrollY + 120;

      for (let i = 0; i < sections.length; i++) {
        const { id, section } = sections[i];
        if (section.offsetTop <= scrollPosition) {
          currentId = id;
        } else {
          break;
        }
      }

      navLinks.forEach(link => {
        link.classList.remove("active");
        if (link.getAttribute("href") === `#${currentId}`) {
          link.classList.add("active");
        }
      });
    }

    window.addEventListener("scroll", updateActiveNav);
    updateActiveNav();
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const observerOptions = {
      root: null,
      rootMargin: "0px 0px -80% 0px", // triggers when top of section is 20% from top
      threshold: 0
    };

    const sections = document.querySelectorAll(".letter-block, .year-block");
    const navLinks = document.querySelectorAll(".az-nav a");

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const id = entry.target.getAttribute("id");
          navLinks.forEach(link => {
            link.classList.toggle("active", link.getAttribute("href") === `#${id}`);
          });
        }
      });
    }, observerOptions);

    sections.forEach(section => observer.observe(section));
  });
</script>

</body>
</html>

